<!DOCTYPE html>
<html>
<head>
    <title>Telemetry Test</title>
</head>
<body>
    <h1>Telemetry Data Test</h1>
    <div id="results"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js'
        import { getDatabase, ref, onValue, query, orderByKey, limitToLast } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js'

        const firebaseConfig = {
            apiKey: "AIzaSyA5IRjwAdvgSQ8K9sTkfdjEgFO_P1K-PdM",
            authDomain: "skyforge-4606b.firebaseapp.com",
            databaseURL: "https://skyforge-4606b-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "skyforge-4606b",
            storageBucket: "skyforge-4606b.firebasestorage.app",
            messagingSenderId: "113983013806",
            appId: "1:113983013806:web:b37570450de08e7a147e3f"
        }

        const app = initializeApp(firebaseConfig)
        const db = getDatabase(app)
        const results = document.getElementById('results')

        function log(message) {
            console.log(message)
            results.innerHTML += '<p>' + message + '</p>'
        }

        log('üîç Testing telemetry data structure...')

        // Test telemetry with latest 5 records
        const telemetryRef = ref(db, 'telemetry')
        const telemetryQuery = query(telemetryRef, orderByKey(), limitToLast(5))

        onValue(telemetryQuery, (snapshot) => {
            const data = snapshot.val()
            
            if (data) {
                log('‚úÖ Found telemetry data:')
                Object.entries(data).forEach(([key, record]) => {
                    log(`üìÖ Timestamp Key: ${key}`)
                    log(`üïê Date: ${new Date(Number(key) * 1000).toLocaleString()}`)
                    log(`üìä Data: ${JSON.stringify(record, null, 2)}`)
                    log(`üìã Fields: ${Object.keys(record).join(', ')}`)
                    log('---')
                })
            } else {
                log('‚ùå No telemetry data found')
            }
        }, (error) => {
            log('‚ùå Error reading telemetry: ' + error.message)
        })
    </script>
</body>
</html>
